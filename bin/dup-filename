#!/usr/bin/env ruby
class DuplicatedFilenameChecker; end
require 'duplicated_filename_checker'

unless ARGV.size > 0
  raise ArgumentError.new('Specify the argument. Argument is survey target root paths.')
end

servey_root_paths = ARGV
duplicated_file_profiles = DuplicatedFilenameChecker::Check.new(*servey_root_paths).execute

duplicated_file_profiles.each do |basename, file_profiles|
  puts "## #{basename}"

  file_profiles.each.with_index(1) do |file_profile, index|
    puts "#{index}. #{file_profile.path}"
    puts " * md5: #{file_profile.md5_digest}"
    puts " * mtime: #{file_profile.stat.mtime}"
    puts "\n"
  end

  puts "\n"
end