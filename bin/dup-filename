#!/usr/bin/env ruby
class DuplicatedFilenameChecker; end
require '../lib/duplicated_filename_checker/check.rb'
require '../lib/duplicated_filename_checker/file_profile.rb'

unless ARGV.size > 0
  raise ArgumentError.new('Specify the argument. Argument is survey target root paths.')
end

servey_root_paths = ARGV
duplicated_file_profiles = DuplicatedFilenameChecker::Check.new(*servey_root_paths).execute

duplicated_file_profiles.each do |basename, file_profiles|
  puts "## #{basename}"

  file_profiles.each do |file_profile|
    puts "#{file_profile.path}"
    puts " * md5: #{file_profile.md5_digest}"
    puts " * mtime: #{file_profile.stat.mtime}"
    puts "\n"
  end

  puts "\n"
end